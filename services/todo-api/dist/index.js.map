{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/controller.ts","webpack:///./src/create.ts","webpack:///./src/delete.ts","webpack:///./src/get.ts","webpack:///./src/index.ts","webpack:///./src/interface.ts","webpack:///./src/list.ts","webpack:///./src/status.ts","webpack:///./src/update.ts","webpack:///external \"@babel/runtime/helpers/interopRequireWildcard\"","webpack:///external \"aws-sdk\"","webpack:///external \"uuid\""],"names":["prepareResponse","body","status_code","JSON","stringify","statusCode","isBase64Encoded","s3","AWS","S3","apiVersion","region","process","env","REGION","signatureVersion","uploadObject","item","uuid","params","Metadata","content","Bucket","TODOS_BUCKET_NAME","Key","putObjectPromise","putObject","promise","then","data","id","catch","err","errorMessage","Error","createItem","event","context","_callback","console","log","parse","res","e","deleteObject","Promise","resolve","reject","toString","deleteItem","pathParameters","getObject","getItem","status","instanceOfTodoItem","object","listObjects","MaxKeys","listObjectsV2","Contents","length","arr","forEach","push","listItems","callback","updateObject","updateItem"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.ts\");\n","export function prepareResponse(body: any, status_code: number) {\n  return {\n    body: JSON.stringify(body, null, 2),\n    statusCode: status_code,\n    isBase64Encoded: false,\n  };\n}\n","import * as AWS from 'aws-sdk';\nimport { v1 as uuidv1 } from 'uuid';\nimport { ITodoItem } from './interface';\nimport { prepareResponse } from './controller';\n\nconst s3 = new AWS.S3({\n  apiVersion: '2006-03-01',\n  region: process.env.REGION || 'eu-west-1',\n  signatureVersion: 'v4',\n});\n\n// async function getMaxId() {\n//   const params = {\n//     Bucket: process.env.TODOS_BUCKET_NAME || '',\n//     MaxKeys: 1000,\n//   };\n//   return new Promise((resolve, reject) => {\n//     s3.listObjectsV2(params, (err: any, data: any) => {\n//       if (err) {\n//         console.log(err);\n//         reject(err);\n//       } else {\n//         if (data.Contents.length === 0) {\n//           resolve(1);\n//         } else {\n//           console.log('Data:', JSON.stringify(data.Contents, null, 2));\n//           let max_id = 0;\n//           data.Contents.forEach((item: any) => {\n//             if (parseInt(item.Key) >= max_id) {\n//               max_id = parseInt(item.Key);\n//             }\n//           });\n//           resolve(max_id + 1);\n//         }\n//       }\n//     });\n//   });\n// }\n\nasync function uploadObject(item: ITodoItem) {\n  const uuid = uuidv1();\n  const params = {\n    Metadata: {\n      content: item.content,\n    },\n    Bucket: process.env.TODOS_BUCKET_NAME || '',\n    Key: uuid,\n  };\n  const putObjectPromise = s3.putObject(params).promise();\n  return putObjectPromise\n    .then((data: any) => {\n      return {\n        id: uuid,\n      };\n    })\n    .catch((err: any) => {\n      const errorMessage = `Failed to upload file to S3: ${err}`;\n      return new Error(errorMessage);\n    });\n}\n\nexport async function createItem(event: any, context: any, _callback: any) {\n  console.log(`Event: ${JSON.stringify(event)}`);\n  try {\n    const item: ITodoItem = JSON.parse(event.body);\n    if (item.content) {\n      return await uploadObject(item).then((res: any) => {\n        return prepareResponse(res, 200);\n      });\n    } else {\n      return prepareResponse('Invalid item type', 500);\n    }\n  } catch (e) {\n    return prepareResponse(e, 501);\n  }\n}\n","import * as AWS from 'aws-sdk';\nimport { prepareResponse } from './controller';\n\nconst s3 = new AWS.S3({\n  apiVersion: '2006-03-01',\n  region: process.env.REGION || 'eu-west-1',\n  signatureVersion: 'v4',\n});\n\nasync function deleteObject(id: number) {\n  return new Promise((resolve, reject) => {\n    const params = {\n      Bucket: process.env.TODOS_BUCKET_NAME || '',\n      Key: id.toString(),\n    };\n    s3.deleteObject(params, (err: any, data: any) => {\n      if (err) {\n        console.log(err);\n        reject(err);\n      } else {\n        resolve({\n          id: id,\n        });\n      }\n    });\n  });\n}\n\nexport async function deleteItem(event: any, context: any, _callback: any) {\n  console.log(`Event: ${JSON.stringify(event)}`);\n  const id = event.pathParameters.id;\n  return prepareResponse(await deleteObject(id), 200);\n}\n","import * as AWS from 'aws-sdk';\nimport { prepareResponse } from './controller';\n\nconst s3 = new AWS.S3({\n  apiVersion: '2006-03-01',\n  region: process.env.REGION || 'eu-west-1',\n  signatureVersion: 'v4',\n});\n\nasync function getObject(id: number) {\n  return new Promise((resolve, reject) => {\n    const params = {\n      Bucket: process.env.TODOS_BUCKET_NAME || '',\n      Key: id.toString(),\n    };\n    s3.getObject(params, (err: any, data: any) => {\n      if (err) {\n        console.log(err);\n        reject(err);\n      } else {\n        resolve({\n          id: id,\n          content: data.Metadata.content,\n        });\n      }\n    });\n  });\n}\n\nexport async function getItem(event: any, context: any, _callback: any) {\n  console.log(`Event: ${JSON.stringify(event)}`);\n  const id = event.pathParameters.id;\n  try {\n    return prepareResponse(await getObject(id), 200);\n  } catch (e) {\n    if (e.statusCode === 403) {\n      return prepareResponse({ id: id, status: 'not-found' }, 404);\n    } else {\n      return prepareResponse(e, 501);\n    }\n  }\n}\n","import { createItem } from './create';\nimport { getItem } from './get';\nimport { deleteItem } from './delete';\nimport { listItems } from './list';\nimport { updateItem } from './update';\nimport { status } from './status';\n\nexport { createItem, getItem, deleteItem, listItems, updateItem, status };\n","export interface ITodoItem {\n  content: string;\n  id: string;\n}\n\nexport function instanceOfTodoItem(object: any): object is ITodoItem {\n  return 'content' in object;\n}\n","import * as AWS from 'aws-sdk';\nimport { prepareResponse } from './controller';\n\nconst s3 = new AWS.S3({\n  apiVersion: '2006-03-01',\n  region: process.env.REGION || 'eu-west-1',\n  signatureVersion: 'v4',\n});\n\nasync function listObjects() {\n  const params = {\n    Bucket: process.env.TODOS_BUCKET_NAME || '',\n    MaxKeys: 1000,\n  };\n  return new Promise((resolve, reject) => {\n    s3.listObjectsV2(params, (err: any, data: any) => {\n      if (err) {\n        console.log(err);\n        reject(err);\n      } else {\n        if (data.Contents.length === 0) {\n          resolve({\n            status: 'empty',\n          });\n        } else {\n          console.log('Data:', JSON.stringify(data.Contents, null, 2));\n          const arr: any[] = [];\n          data.Contents.forEach((item: any) => {\n            arr.push({\n              id: item.Key,\n            });\n          });\n          resolve(arr);\n        }\n      }\n    });\n  });\n}\n\nexport async function listItems(event: any, context: any, _callback: any) {\n  console.log(`Event: ${JSON.stringify(event)}`);\n  return prepareResponse(await listObjects(), 200);\n}\n","import { v1 as uuidv1 } from 'uuid';\nimport { prepareResponse } from './controller';\n\nexport function status(event: any, context: any, callback: any) {\n  console.log(`Console uuid is: ${uuidv1()}`);\n  callback(\n    null,\n    prepareResponse(\n      {\n        status: 'healthy',\n        uuid: uuidv1(),\n      },\n      200,\n    ),\n  );\n}\n","import * as AWS from 'aws-sdk';\nimport { ITodoItem, instanceOfTodoItem } from './interface';\nimport { prepareResponse } from './controller';\n\nconst s3 = new AWS.S3({\n  apiVersion: '2006-03-01',\n  region: process.env.REGION || 'eu-west-1',\n  signatureVersion: 'v4',\n});\n\nasync function updateObject(item: ITodoItem) {\n  const params = {\n    Metadata: {\n      content: item.content,\n    },\n    Bucket: process.env.TODOS_BUCKET_NAME || '',\n    Key: item.id.toString(),\n  };\n  const putObjectPromise = s3.putObject(params).promise();\n  return putObjectPromise\n    .then((data: any) => {\n      console.log(data);\n      return {\n        id: item.id,\n      };\n    })\n    .catch((err: any) => {\n      const errorMessage = `Failed to upload file to S3: ${err}`;\n      return new Error(errorMessage);\n    });\n}\n\nexport async function updateItem(event: any, context: any, _callback: any) {\n  console.log(`Event: ${JSON.stringify(event)}`);\n  try {\n    const item: ITodoItem = JSON.parse(event.body);\n    if (instanceOfTodoItem(item)) {\n      return await updateObject(item).then((res: any) => {\n        console.log(res);\n        return prepareResponse(res, 200);\n      });\n    } else {\n      return prepareResponse('Invalid item type', 500);\n    }\n  } catch (e) {\n    return prepareResponse(e, 501);\n  }\n}\n","module.exports = require(\"@babel/runtime/helpers/interopRequireWildcard\");","module.exports = require(\"aws-sdk\");","module.exports = require(\"uuid\");"],"sourceRoot":""}